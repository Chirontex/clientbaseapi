# Client Base API Handler
**Client Base API Handler** — модуль для работы с API CRM-платформы «Клиентская база».

![](https://img.shields.io/badge/PHP-7%2B-yellow) ![](https://img.shields.io/badge/version-0.5-informational)

В данной версии доступны только CRUD-операции с данными в таблицах.

## Установка:
1. Скачайте архив с последним релизом модуля и распакуйте его.
2. Подключите автозагрузчик.
```php
use ClientBaseAPI\Handler;
require_once __DIR__.'/ClientBaseAPI/autoload.php';
```

## Как пользоваться:
1. Доступ в «Клиентскую базу» через API осуществляется посредством пользовательской авторизации. Для того, чтобы работать с API «Клиентской базы», вам нужно сгенерировать сгенерировать ключ доступа для вашего аккаунта в «Клиентской базе». Сделайте это в настройках API-модуля, которые, в свою очередь, располагаются в настройках «Клиентской базы».
2. Создайте объект класса ClientBaseAPI\Handler.
```php
// Вставьте вместо http://your-client-base.ru/
// настоящий адрес вашей «Клиентской базы»,
// вместо login — логин вашего аккаунта в «Клиентской базе»,
// вместо key — сгенерированный пунктом выше ключ.
$cbapi = new Handler('http://your-client-base.ru/', 'login', 'key');
```
3. Для доступа к CRUD-операциям используйте методы dataCreate(), dataRead(), dataUpdate() и dataDelete(), передавая в них в качестве аргумента массив с командой, составленный согласно [официальной документации «Клиенской базы](https://clientbase.ru/help/for_admin_16/api/ "официальной документации «Клиенской базы")». Также, вы можете использовать метод crud(), однако в случае с ним первым аргументом должно идти название нужной CRUD-операции (например, read), а вторым — массив с командой.
```php
// Пример добавления записи в таблицу
// с помощью метода ClientBaseAPI\Handler::dataCreate().
$command = ['table_id' => 74, 'cals' => true];
$command['data']['row'] = ['f807' => 'Хлеб', 'f810' => 17];
// Формат ответа см. здесь:
// https://clientbase.ru/help/for_admin_16/api/data/create/
$result = $cbapi->dataCreate($command);
// Та же самая операция,
// но с использованием метода ClientBaseAPI\Handler::crud().
$result = $cbapi->crud('create', $command);
```